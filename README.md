# Non-Gaussian Surface Simulations

**Author:** Sebastian Korsak

# 🎲 Johnson Distribution Moment Fitter

A Python implementation of Johnson distribution fitting based on the first four moments: **mean**, **standard deviation**, **skewness**, and **kurtosis**.  
This tool approximates the functionality of MATLAB's `pearsrnd()` and the **Johnson Curve Toolbox** by Dave (2014–2021).

Ported and extended by Max Pierini and contributors.

---

## 🔧 Function

```python
f_johnson_M(mu, sd, skew, kurt)
```

Estimates the parameters of a **Johnson distribution** (SL, SU, SB, SN, ST) to match specified statistical moments.

---

## 📥 Parameters

| Parameter | Type   | Description |
|-----------|--------|-------------|
| `mu`      | float  | Desired **mean** of the distribution |
| `sd`      | float  | Desired **standard deviation** |
| `skew`    | float  | Desired **skewness** (3rd standardized moment) |
| `kurt`    | float  | Desired **kurtosis** (4th standardized moment, not excess) |

---

## 📤 Returns

```python
coef, dist_type, error_msg = f_johnson_M(mu, sd, skew, kurt)
```

| Return        | Type    | Description |
|---------------|---------|-------------|
| `coef`        | tuple   | `(gamma, delta, xi, lambda)` — parameters of the Johnson distribution |
| `dist_type`   | str     | Johnson type: `'SL'`, `'SU'`, `'SB'`, `'SN'`, `'ST'` |
| `error_msg`   | str     | Explanation or warning, empty if successful |

---

## 📚 Johnson Distribution Types

| Code | Type      | Description                                     |
|------|-----------|-------------------------------------------------|
| SL   | Lognormal | Positive-only, skewed                          |
| SU   | Unbounded | Skewed, supports full ℝ                        |
| SB   | Bounded   | Supports bounded intervals [0,1], fragile fit |
| SN   | Normal    | Used when skew ≈ 0 and kurtosis ≈ 3           |
| ST   | Two-piece normal | Backup for certain boundary cases     |

---

## 🚀 Example

```python
from f_johnson_M import f_johnson_M
from scipy.stats import johnsonsu
import matplotlib.pyplot as plt

# Desired statistical properties
mu = 0
sigma = 1
skew = 1.5
kurt = 5

# Estimate Johnson parameters
params, dtype, msg = f_johnson_M(mu, sigma, skew, kurt)
gamma, delta, xi, lam = params

# Sample from the fitted distribution
samples = johnsonsu.rvs(a=gamma, b=delta, loc=xi, scale=lam, size=10000)

# Plot histogram
plt.hist(samples, bins=100, density=True)
plt.title(f'Johnson {dtype} Distribution')
plt.show()
```

---

## ⚠️ Notes & Limitations

- The tool **matches target moments** using moment-based inference and numerical root-finding.
- **SB distributions** may fail to converge for some moment combinations — fallback to `'ST'` is automatic.
- Results are **approximate** due to sampling variability and numerical limitations.
- Equivalent to MATLAB’s `pearsrnd()` but only covers **Johnson system**, not all Pearson types.

---

## 📜 References

- Dave (2021). *Johnson Curve Toolbox*. [MATLAB Central File Exchange](https://www.mathworks.com/matlabcentral/fileexchange/46123-johnson-curve-toolbox)
- Johnson, N.L. (1949). *Systems of frequency curves generated by methods of translation*.

---

## 📂 License

MIT License. See `LICENSE` file.

---

## 👥 Credits

- Python translation by Max Pierini @ [EpiData.it](https://epidata.it)
- Ported from original MATLAB toolbox by Dave (2021)
- Extended and maintained by [your name here]

# Results

![image](https://github.com/user-attachments/assets/be9a6f7b-90c5-4240-89bc-78a295d5c9bb)

![image](https://github.com/user-attachments/assets/a328b67c-366d-4d67-ab96-d95e5e2e6f12)
